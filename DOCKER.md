# Общая информация

В данном файле описаны изменения в проекте, которые были сделаны для его публикации в образы Docker.

Проект состоит из следующих сервисов (образов), описанных в разделах файла **_docker-compose.yml_** и размещаемых в отдельных контейнерах:

| Сервис   | Внешний<br/>порт | Описание                                                                                                                                                                                |
|----------|------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| db       | 5432             | СУБД Postgres с базой данных проекта                                                                                                                                                    |
| adminer  | 8081             | Административный интерфейс СУБД. Для доступа к БД проекта необходимо ввести реквизиты _POSTGRES_*_ из файла окружения _.env_ для _docker-compose.yml_                                   |
| backend  | 8080             | Backend проекта на Django Rest Framework (python) под управлением сервера Gunicorn                                                                                                      |
| nginx    | 8000             | Web-сервер backend'а и frontend'а проекта                                                                                                                                               |
| frontend | 80               | Frontend проекта на React (javascript). При сборке проекта ожидается, что уже выполнена компиляция frontend'а (_npm run build_) и файлы скомпилированного frontend'а лежат в папке _build/_ |

# Новые файлы и их назначение

В проект были добавлены следующие файлы:

| Папка                                 | Файл                 | Описание                                                                                                                                          |
|---------------------------------------|----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| /                                     | docker-compose.yml   | Главный конфигурационный файл Docker Compose для сборки проекта                                                                                   |
| /                                     | .env                 | Файл окружения (environment) для docker-compose.yml, где хранятся данные, которые не надо размещать в публичном доступе (логины, пароли и прочее) |
| /                                     | wait-for-postgres.sh | bash-скрипт, ожидающий, когда поднимется СУБД Postgres, во избежание ошибок миграции баз данных Django.                                           |
| /todo_notes                           | Dockerfile           | Конфигурационный файл Docker для backend'а                                                                                                        |
| /todo_notes                           | requirements.txt     | Сгенерированный командой **_pip freeze_** список зависимостей (сторонних библиотек) проекта, используемый в Dockerfile backend'а                  |
| /todo_notes/users/management/commands | create_superuser.py  | Командный скрипт management.py для создания суперюзера Django                                                                                     |
| /nginx                                | nginx.conf           | Файл конфигурации сервера nginx                                                                                                                   |
| /nginx                                | Dockerfile           | Конфигурационный файл Docker для nginx                                                                                                            |
| /frontend                             | nginx.conf           | Файл конфигурации nginx для frontend'а                                                                                                            |
| /frontend                             | Dockerfile           | Конфигурационный файл Docker для frontend'а                                                                                                       |

# Дополнительные установленные библиотеки и программные средства backend'а

- PostgreSQL - так как принято решение разворачивать production-конфигурацию; используется в случае прописывания в 
_settings.py_ в словаре _DATABASES_ СУБД Postgres (см. ниже).


    pip install psycopg2-binary

- Gunicorn - используется только в конфигурации для Docker, устанавливается из Dockerfile backend'а (см. выше) и
запускается из _docker-compose.yml_.


    pip install gunicorn

# Изменения в существующих файлах

| Папка                  | Файл        | Описание                                                                                                                               |
|------------------------|-------------|----------------------------------------------------------------------------------------------------------------------------------------|
| /todo_notes/todo_notes | settings.py | - в список **_ALLOWED_HOSTS_** добавлен хост _0.0.0.0_ для Docker и _127.0.0.1_ для локальной установки                                |
|                        |             | - в список **_CORS_ALLOWED_ORIGINS_** добавлен URL _http://0.0.0.0_ для Docker для обеспечения работоспособности frontend'а            |
|                        |             | - в словаре **_DATABASES_** БД _'default'_ изменена с SQLite Django (закомментирована) на Postgres с именем хоста db в Docker          |
| /frontend/src          | App.js      | переменная **_URL_BASE_** изменена и указывает на адрес _0.0.0.0_ контейнера Docker, значение для локальной установки закомментировано |

# Уязвимости

1. файл /.env необходимо исключить из дистрибутива - содержит логин и пароль супервизора
2. 
3. 